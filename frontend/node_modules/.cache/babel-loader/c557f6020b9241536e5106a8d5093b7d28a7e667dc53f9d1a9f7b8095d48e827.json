{"ast":null,"code":"import dayjs from \"dayjs\";\nimport { AbstractParserWithWordBoundaryChecking } from \"../../../../common/parsers/AbstractParserWithWordBoundary.js\";\nimport { WEEKDAY_OFFSET } from \"../constants.js\";\nconst PATTERN = new RegExp(\"(?:星期|礼拜|周)(?<weekday>\" + Object.keys(WEEKDAY_OFFSET).join(\"|\") + \")\");\nexport default class ZHHansWeekdayParser extends AbstractParserWithWordBoundaryChecking {\n  innerPattern() {\n    return PATTERN;\n  }\n  innerExtract(context, match) {\n    const result = context.createParsingResult(match.index, match[0]);\n    const dayOfWeek = match.groups.weekday;\n    const offset = WEEKDAY_OFFSET[dayOfWeek];\n    if (offset === undefined) return null;\n    let startMoment = dayjs(context.refDate);\n    const startMomentFixed = false;\n    const refOffset = startMoment.day();\n    if (Math.abs(offset - 7 - refOffset) < Math.abs(offset - refOffset)) {\n      startMoment = startMoment.day(offset - 7);\n    } else if (Math.abs(offset + 7 - refOffset) < Math.abs(offset - refOffset)) {\n      startMoment = startMoment.day(offset + 7);\n    } else {\n      startMoment = startMoment.day(offset);\n    }\n    result.start.assign(\"weekday\", offset);\n    if (startMomentFixed) {\n      result.start.assign(\"day\", startMoment.date());\n      result.start.assign(\"month\", startMoment.month() + 1);\n      result.start.assign(\"year\", startMoment.year());\n    } else {\n      result.start.imply(\"day\", startMoment.date());\n      result.start.imply(\"month\", startMoment.month() + 1);\n      result.start.imply(\"year\", startMoment.year());\n    }\n    return result;\n  }\n}","map":{"version":3,"names":["dayjs","AbstractParserWithWordBoundaryChecking","WEEKDAY_OFFSET","PATTERN","RegExp","Object","keys","join","ZHHansWeekdayParser","innerPattern","innerExtract","context","match","result","createParsingResult","index","dayOfWeek","groups","weekday","offset","undefined","startMoment","refDate","startMomentFixed","refOffset","day","Math","abs","start","assign","date","month","year","imply"],"sources":["/Users/mvikr/Projects/TaskApp/frontend/node_modules/chrono-node/src/locales/zh/hans/parsers/ZHHansWeekdayParser.ts"],"sourcesContent":["import dayjs from \"dayjs\";\nimport { ParsingContext } from \"../../../../chrono\";\nimport { AbstractParserWithWordBoundaryChecking } from \"../../../../common/parsers/AbstractParserWithWordBoundary\";\nimport { ParsingResult } from \"../../../../results\";\nimport { WEEKDAY_OFFSET } from \"../constants\";\n\nconst PATTERN = new RegExp(\"(?:星期|礼拜|周)(?<weekday>\" + Object.keys(WEEKDAY_OFFSET).join(\"|\") + \")\");\n\nexport default class ZHHansWeekdayParser extends AbstractParserWithWordBoundaryChecking {\n    innerPattern(): RegExp {\n        return PATTERN;\n    }\n\n    innerExtract(context: ParsingContext, match: RegExpMatchArray): ParsingResult {\n        const result = context.createParsingResult(match.index, match[0]);\n\n        const dayOfWeek = match.groups.weekday;\n        const offset = WEEKDAY_OFFSET[dayOfWeek];\n        if (offset === undefined) return null;\n\n        let startMoment = dayjs(context.refDate);\n        const startMomentFixed = false;\n        const refOffset = startMoment.day();\n\n        if (Math.abs(offset - 7 - refOffset) < Math.abs(offset - refOffset)) {\n            startMoment = startMoment.day(offset - 7);\n        } else if (Math.abs(offset + 7 - refOffset) < Math.abs(offset - refOffset)) {\n            startMoment = startMoment.day(offset + 7);\n        } else {\n            startMoment = startMoment.day(offset);\n        }\n\n        result.start.assign(\"weekday\", offset);\n        if (startMomentFixed) {\n            result.start.assign(\"day\", startMoment.date());\n            result.start.assign(\"month\", startMoment.month() + 1);\n            result.start.assign(\"year\", startMoment.year());\n        } else {\n            result.start.imply(\"day\", startMoment.date());\n            result.start.imply(\"month\", startMoment.month() + 1);\n            result.start.imply(\"year\", startMoment.year());\n        }\n\n        return result;\n    }\n}\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,SAASC,sCAAsC,QAAQ,8DAA4D;AAEnH,SAASC,cAAc,QAAQ,iBAAe;AAE9C,MAAMC,OAAO,GAAG,IAAIC,MAAM,CAAC,wBAAwB,GAAGC,MAAM,CAACC,IAAI,CAACJ,cAAc,CAAC,CAACK,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;AAElG,eAAc,MAAOC,mBAAoB,SAAQP,sCAAsC;EACnFQ,YAAYA,CAAA;IACR,OAAON,OAAO;EAClB;EAEAO,YAAYA,CAACC,OAAuB,EAAEC,KAAuB;IACzD,MAAMC,MAAM,GAAGF,OAAO,CAACG,mBAAmB,CAACF,KAAK,CAACG,KAAK,EAAEH,KAAK,CAAC,CAAC,CAAC,CAAC;IAEjE,MAAMI,SAAS,GAAGJ,KAAK,CAACK,MAAM,CAACC,OAAO;IACtC,MAAMC,MAAM,GAAGjB,cAAc,CAACc,SAAS,CAAC;IACxC,IAAIG,MAAM,KAAKC,SAAS,EAAE,OAAO,IAAI;IAErC,IAAIC,WAAW,GAAGrB,KAAK,CAACW,OAAO,CAACW,OAAO,CAAC;IACxC,MAAMC,gBAAgB,GAAG,KAAK;IAC9B,MAAMC,SAAS,GAAGH,WAAW,CAACI,GAAG,EAAE;IAEnC,IAAIC,IAAI,CAACC,GAAG,CAACR,MAAM,GAAG,CAAC,GAAGK,SAAS,CAAC,GAAGE,IAAI,CAACC,GAAG,CAACR,MAAM,GAAGK,SAAS,CAAC,EAAE;MACjEH,WAAW,GAAGA,WAAW,CAACI,GAAG,CAACN,MAAM,GAAG,CAAC,CAAC;KAC5C,MAAM,IAAIO,IAAI,CAACC,GAAG,CAACR,MAAM,GAAG,CAAC,GAAGK,SAAS,CAAC,GAAGE,IAAI,CAACC,GAAG,CAACR,MAAM,GAAGK,SAAS,CAAC,EAAE;MACxEH,WAAW,GAAGA,WAAW,CAACI,GAAG,CAACN,MAAM,GAAG,CAAC,CAAC;KAC5C,MAAM;MACHE,WAAW,GAAGA,WAAW,CAACI,GAAG,CAACN,MAAM,CAAC;;IAGzCN,MAAM,CAACe,KAAK,CAACC,MAAM,CAAC,SAAS,EAAEV,MAAM,CAAC;IACtC,IAAII,gBAAgB,EAAE;MAClBV,MAAM,CAACe,KAAK,CAACC,MAAM,CAAC,KAAK,EAAER,WAAW,CAACS,IAAI,EAAE,CAAC;MAC9CjB,MAAM,CAACe,KAAK,CAACC,MAAM,CAAC,OAAO,EAAER,WAAW,CAACU,KAAK,EAAE,GAAG,CAAC,CAAC;MACrDlB,MAAM,CAACe,KAAK,CAACC,MAAM,CAAC,MAAM,EAAER,WAAW,CAACW,IAAI,EAAE,CAAC;KAClD,MAAM;MACHnB,MAAM,CAACe,KAAK,CAACK,KAAK,CAAC,KAAK,EAAEZ,WAAW,CAACS,IAAI,EAAE,CAAC;MAC7CjB,MAAM,CAACe,KAAK,CAACK,KAAK,CAAC,OAAO,EAAEZ,WAAW,CAACU,KAAK,EAAE,GAAG,CAAC,CAAC;MACpDlB,MAAM,CAACe,KAAK,CAACK,KAAK,CAAC,MAAM,EAAEZ,WAAW,CAACW,IAAI,EAAE,CAAC;;IAGlD,OAAOnB,MAAM;EACjB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}